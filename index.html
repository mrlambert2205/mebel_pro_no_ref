<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>“ö–æ–π–º–∞ –ë–∞—Å“õ–∞—Ä—É –ñ“Ø–π–µ—Å—ñ - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∫–µ –¥–µ–π—ñ–Ω</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .main-content {
            padding: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #333;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #48c774;
            color: white;
        }

        .btn-warning {
            background: #ffdd57;
            color: rgba(0,0,0,0.7);
        }

        .btn-danger {
            background: #f14668;
            color: white;
        }

        .search-section {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .search-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .tables-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .table-section {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 20px;
        }

        .table-section h2 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            text-align: left;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .action-link {
            color: #667eea;
            cursor: pointer;
            margin: 0 5px;
            text-decoration: underline;
        }

        .action-link.delete {
            color: #f14668;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-content h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            animation: slideIn 0.3s ease;
            z-index: 2000;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success {
            background: #48c774;
        }

        .notification.error {
            background: #f14668;
        }

        .notification.info {
            background: #3298dc;
        }

        .price-calculator {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .price-calculator h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .price-display {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè≠ “ö–æ–π–º–∞ –ë–∞—Å“õ–∞—Ä—É –ñ“Ø–π–µ—Å—ñ</h1>
            <p>–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∫–µ –¥–µ–π—ñ–Ω - –ú–æ–Ω–æ–ª–∏—Ç—Ç—ñ–∫ –Ω“±—Å“õ–∞</p>
        </div>

        <div class="main-content">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>–ë–∞—Ä–ª—ã“õ ”©–Ω—ñ–º–¥–µ—Ä</h3>
                    <div class="number" id="totalProducts">0</div>
                </div>
                <div class="stat-card">
                    <h3>–ë–∞—Ä–ª—ã“õ —Å–∞–Ω–∞—Ç—Ç–∞—Ä</h3>
                    <div class="number" id="totalCategories">0</div>
                </div>
                <div class="stat-card">
                    <h3>–ñ–∞–ª–ø—ã “õ“±–Ω</h3>
                    <div class="number" id="totalValue">‚Ç∏0</div>
                </div>
                <div class="stat-card">
                    <h3>–ê–∑ “õ–∞–ª“ì–∞–Ω —Ç–∞—É–∞—Ä–ª–∞—Ä</h3>
                    <div class="number" id="lowStockItems">0</div>
                </div>
            </div>

            <!-- ”ò—Ä–µ–∫–µ—Ç —Ç“Ø–π–º–µ–ª–µ—Ä—ñ -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="showModal('product')">‚ûï ”®–Ω—ñ–º “õ–æ—Å—É</button>
                <button class="btn btn-primary" onclick="showModal('category')">üìÅ –°–∞–Ω–∞—Ç “õ–æ—Å—É</button>
                <button class="btn btn-success" onclick="generateReport()">üìä –ï—Å–µ–ø –¥–∞–π—ã–Ω–¥–∞—É</button>
                <button class="btn btn-warning" onclick="applyBulkDiscount()">üè∑Ô∏è –ñ–∞–ø–ø–∞–π –∂–µ“£—ñ–ª–¥—ñ–∫</button>
                <button class="btn btn-warning" onclick="calculateInventoryValue()">üí∞ “ö“±–Ω–¥—ã –µ—Å–µ–ø—Ç–µ—É</button>
                <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è –ë–∞—Ä–ª—ã“ì—ã–Ω —Ç–∞–∑–∞–ª–∞—É</button>
            </div>

            <!-- –Ü–∑–¥–µ—É —Å–µ–∫—Ü–∏—è—Å—ã -->
            <div class="search-section">
                <input type="text" class="search-input" id="searchInput" placeholder="”®–Ω—ñ–º–¥–µ—Ä–¥—ñ –∞—Ç—ã, —Å–∞–Ω–∞—Ç—ã –Ω–µ–º–µ—Å–µ —Å–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã –±–æ–π—ã–Ω—à–∞ —ñ–∑–¥–µ—É..." onkeyup="searchProducts()">
                <select class="search-input" id="categoryFilter" onchange="filterByCategory()">
                    <option value="">–ë–∞—Ä–ª—ã“õ —Å–∞–Ω–∞—Ç—Ç–∞—Ä</option>
                </select>
            </div>

            <!-- –ö–µ—Å—Ç–µ–ª–µ—Ä -->
            <div class="tables-container">
                <div class="table-section">
                    <h2>üì¶ ”®–Ω—ñ–º–¥–µ—Ä</h2>
                    <table id="productsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ê—Ç—ã</th>
                                <th>–°–∞–Ω–∞—Ç—ã</th>
                                <th>–ë–∞“ì–∞—Å—ã</th>
                                <th>–°–∞–Ω—ã</th>
                                <th>”ò—Ä–µ–∫–µ—Ç—Ç–µ—Ä</th>
                            </tr>
                        </thead>
                        <tbody id="productsBody"></tbody>
                    </table>
                </div>

                <div class="table-section">
                    <h2>üìÅ –°–∞–Ω–∞—Ç—Ç–∞—Ä</h2>
                    <table id="categoriesTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ê—Ç—ã</th>
                                <th>–°–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã</th>
                                <th>”ò—Ä–µ–∫–µ—Ç—Ç–µ—Ä</th>
                            </tr>
                        </thead>
                        <tbody id="categoriesBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- –ë–∞“ì–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã -->
            <div class="price-calculator">
                <h3>üí∞ –ë–∞“ì–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã (–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω—ñ - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∫–µ –¥–µ–π—ñ–Ω)</h3>
                <div class="form-group">
                    <label>–ù–µ–≥—ñ–∑–≥—ñ –±–∞“ì–∞:</label>
                    <input type="number" id="basePrice" value="100" onchange="calculatePrice()">
                </div>
                <div class="form-group">
                    <label>–ñ–µ“£—ñ–ª–¥—ñ–∫ —Ç“Ø—Ä—ñ:</label>
                    <select id="discountType" onchange="calculatePrice()">
                        <option value="none">–ñ–µ“£—ñ–ª–¥—ñ–∫—Å—ñ–∑</option>
                        <option value="regular">–ö”ô–¥—ñ–º–≥—ñ (10%)</option>
                        <option value="premium">–ü—Ä–µ–º–∏—É–º (20%)</option>
                        <option value="vip">VIP (30%)</option>
                        <option value="seasonal">–ú–∞—É—Å—ã–º–¥—ã“õ (15%)</option>
                        <option value="clearance">–¢–∞–∑–∞—Ä—Ç—É (40%)</option>
                    </select>
                </div>
                <div class="price-display" id="calculatedPrice">‚Ç∏100.00</div>
            </div>
        </div>
    </div>

    <!-- ”®–Ω—ñ–º –º–æ–¥–∞–ª—ã -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <h2 id="productModalTitle">”®–Ω—ñ–º “õ–æ—Å—É</h2>
            <form id="productForm" onsubmit="event.preventDefault(); saveProduct();">
                <input type="hidden" id="productId">
                <div class="form-group">
                    <label>”®–Ω—ñ–º –∞—Ç—ã:</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>–°–∞–Ω–∞—Ç—ã:</label>
                    <select id="productCategory" required></select>
                </div>
                <div class="form-group">
                    <label>–ë–∞“ì–∞—Å—ã (‚Ç∏):</label>
                    <input type="number" id="productPrice" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label>–°–∞–Ω—ã:</label>
                    <input type="number" id="productQuantity" min="0" required>
                </div>
                <div class="form-group">
                    <label>–°–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã:</label>
                    <textarea id="productDescription"></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-danger" onclick="closeModal('product')">–ë–æ–ª–¥—ã—Ä–º–∞—É</button>
                    <button type="submit" class="btn btn-success">–°–∞“õ—Ç–∞—É</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –°–∞–Ω–∞—Ç –º–æ–¥–∞–ª—ã -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <h2 id="categoryModalTitle">–°–∞–Ω–∞—Ç “õ–æ—Å—É</h2>
            <form id="categoryForm" onsubmit="event.preventDefault(); saveCategory();">
                <input type="hidden" id="categoryId">
                <div class="form-group">
                    <label>–°–∞–Ω–∞—Ç –∞—Ç—ã:</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label>–°–∏–ø–∞—Ç—Ç–∞–º–∞—Å—ã:</label>
                    <textarea id="categoryDescription"></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-danger" onclick="closeModal('category')">–ë–æ–ª–¥—ã—Ä–º–∞—É</button>
                    <button type="submit" class="btn btn-success">–°–∞“õ—Ç–∞—É</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // –ñ–∞“ª–∞–Ω–¥—ã“õ –∞–π–Ω—ã–º–∞–ª—ã–ª–∞—Ä - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∫–µ –¥–µ–π—ñ–Ω–≥—ñ –∂–∞–º–∞–Ω —Ç”ô–∂—ñ—Ä–∏–±–µ
        let products = [];
        let categories = [];
        let nextProductId = 1;
        let nextCategoryId = 1;
        let notificationTimeout = null;

        // –ë–∞—Å—Ç–∞–ø“õ—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä–º–µ–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è–ª–∞—É
        function initData() {
            // “Æ–ª–≥—ñ —Å–∞–Ω–∞—Ç—Ç–∞—Ä
            categories = [
                { id: 1, name: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', description: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–¥—ã “õ“±—Ä—ã–ª“ì—ã–ª–∞—Ä –º–µ–Ω –≥–∞–¥–∂–µ—Ç—Ç–µ—Ä' },
                { id: 2, name: '–ñ–∏“ª–∞–∑', description: '“Æ–π –∂”ô–Ω–µ –∫–µ“£—Å–µ –∂–∏“ª–∞–∑—ã' },
                { id: 3, name: '–ö–∏—ñ–º', description: '–ö–∏—ñ–º–¥–µ—Ä –º–µ–Ω –∞–∫—Å–µ—Å—Å—É–∞—Ä–ª–∞—Ä' }
            ];
            nextCategoryId = 4;

            // “Æ–ª–≥—ñ ”©–Ω—ñ–º–¥–µ—Ä
            products = [
                { id: 1, name: '–ù–æ—É—Ç–±—É–∫', categoryId: 1, price: 450000, quantity: 10, description: '–ñ–æ“ì–∞—Ä—ã ”©–Ω—ñ–º–¥—ñ –Ω–æ—É—Ç–±—É–∫' },
                { id: 2, name: '–ö–µ“£—Å–µ –æ—Ä–Ω—ã', categoryId: 2, price: 85000, quantity: 5, description: '–≠—Ä–≥–æ–Ω–æ–º–∏–∫–∞–ª—ã“õ –∫–µ“£—Å–µ –æ—Ä–Ω—ã' },
                { id: 3, name: '–§—É—Ç–±–æ–ª–∫–∞', categoryId: 3, price: 5000, quantity: 50, description: '–ú–∞“õ—Ç–∞ —Ñ—É—Ç–±–æ–ª–∫–∞' }
            ];
            nextProductId = 4;

            updateAllDisplays();
        }

        // ”®–Ω—ñ–º–¥–µ—Ä–≥–µ –∞—Ä–Ω–∞–ª“ì–∞–Ω CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–ª–∞—Ä—ã
        function getAllProducts() {
            return products.map(product => {
                const category = categories.find(c => c.id === product.categoryId);
                return {
                    ...product,
                    categoryName: category ? category.name : '–ë–µ–ª–≥—ñ—Å—ñ–∑'
                };
            });
        }

        function getProductById(id) {
            return products.find(p => p.id === parseInt(id));
        }

        function createProduct(productData) {
            const newProduct = {
                id: nextProductId++,
                ...productData,
                categoryId: parseInt(productData.categoryId)
            };
            products.push(newProduct);
            showNotification('”®–Ω—ñ–º —Å”ô—Ç—Ç—ñ “õ–æ—Å—ã–ª–¥—ã!', 'success');
            updateAllDisplays();
            return newProduct;
        }

        function updateProduct(id, productData) {
            const index = products.findIndex(p => p.id === parseInt(id));
            if (index !== -1) {
                products[index] = {
                    ...products[index],
                    ...productData,
                    categoryId: parseInt(productData.categoryId)
                };
                showNotification('”®–Ω—ñ–º —Å”ô—Ç—Ç—ñ –∂–∞“£–∞—Ä—Ç—ã–ª–¥—ã!', 'success');
                updateAllDisplays();
                return products[index];
            }
            return null;
        }

        function deleteProduct(id) {
            const index = products.findIndex(p => p.id === parseInt(id));
            if (index !== -1) {
                products.splice(index, 1);
                showNotification('”®–Ω—ñ–º —Å”ô—Ç—Ç—ñ –∂–æ–π—ã–ª–¥—ã!', 'success');
                updateAllDisplays();
                return true;
            }
            return false;
        }

        // –°–∞–Ω–∞—Ç—Ç–∞—Ä“ì–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–ª–∞—Ä—ã
        function getAllCategories() {
            return categories;
        }

        function getCategoryById(id) {
            return categories.find(c => c.id === parseInt(id));
        }

        function createCategory(categoryData) {
            const newCategory = {
                id: nextCategoryId++,
                ...categoryData
            };
            categories.push(newCategory);
            showNotification('–°–∞–Ω–∞—Ç —Å”ô—Ç—Ç—ñ “õ–æ—Å—ã–ª–¥—ã!', 'success');
            updateAllDisplays();
            return newCategory;
        }

        function updateCategory(id, categoryData) {
            const index = categories.findIndex(c => c.id === parseInt(id));
            if (index !== -1) {
                categories[index] = {
                    ...categories[index],
                    ...categoryData
                };
                showNotification('–°–∞–Ω–∞—Ç —Å”ô—Ç—Ç—ñ –∂–∞“£–∞—Ä—Ç—ã–ª–¥—ã!', 'success');
                updateAllDisplays();
                return categories[index];
            }
            return null;
        }

        function deleteCategory(id) {
            // –°–∞–Ω–∞—Ç—Ç–∞ ”©–Ω—ñ–º–¥–µ—Ä –±–∞—Ä –º–∞ —Ç–µ–∫—Å–µ—Ä–µ–º—ñ–∑
            const hasProducts = products.some(p => p.categoryId === parseInt(id));
            if (hasProducts) {
                showNotification('”®–Ω—ñ–º–¥–µ—Ä—ñ –±–∞—Ä —Å–∞–Ω–∞—Ç—Ç—ã –∂–æ—é –º“Ø–º–∫—ñ–Ω –µ–º–µ—Å!', 'error');
                return false;
            }

            const index = categories.findIndex(c => c.id === parseInt(id));
            if (index !== -1) {
                categories.splice(index, 1);
                showNotification('–°–∞–Ω–∞—Ç —Å”ô—Ç—Ç—ñ –∂–æ–π—ã–ª–¥—ã!', 'success');
                updateAllDisplays();
                return true;
            }
            return false;
        }

        // –ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞ 1: “ö–æ–π–º–∞–Ω—ã“£ –∂–∞–ª–ø—ã “õ“±–Ω—ã–Ω –µ—Å–µ–ø—Ç–µ—É
        function calculateTotalInventoryValue() {
            let total = 0;
            for (let i = 0; i < products.length; i++) {
                total += products[i].price * products[i].quantity;
            }
            return total;
        }

        // –ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞ 2: –ê–∑ “õ–∞–ª“ì–∞–Ω ”©–Ω—ñ–º–¥–µ—Ä–¥—ñ —Ç–µ–∫—Å–µ—Ä—É
        function getLowStockItems(threshold = 10) {
            const lowStock = [];
            for (let i = 0; i < products.length; i++) {
                if (products[i].quantity < threshold) {
                    const category = getCategoryById(products[i].categoryId);
                    lowStock.push({
                        ...products[i],
                        categoryName: category ? category.name : '–ë–µ–ª–≥—ñ—Å—ñ–∑'
                    });
                }
            }
            return lowStock;
        }

        // –ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞ 3: –ñ–∞–ø–ø–∞–π –∂–µ“£—ñ–ª–¥—ñ–∫ “õ–æ–ª–¥–∞–Ω—É
        function applyBulkDiscount(discountPercent = 10, categoryId = null) {
            for (let i = 0; i < products.length; i++) {
                if (!categoryId || products[i].categoryId === parseInt(categoryId)) {
                    products[i].price = products[i].price * (1 - discountPercent / 100);
                }
            }
            showNotification(`${discountPercent}% –∂–µ“£—ñ–ª–¥—ñ–∫ “õ–æ–ª–¥–∞–Ω—ã–ª–¥—ã!`, 'success');
            updateAllDisplays();
        }

        // –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω—ñ (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∫–µ –¥–µ–π—ñ–Ω)
        function calculatePriceWithDiscount(basePrice, discountType) {
            switch(discountType) {
                case 'regular':
                    return basePrice * 0.9; // 10% –∂–µ“£—ñ–ª–¥—ñ–∫
                case 'premium':
                    return basePrice * 0.8; // 20% –∂–µ“£—ñ–ª–¥—ñ–∫
                case 'vip':
                    return basePrice * 0.7; // 30% –∂–µ“£—ñ–ª–¥—ñ–∫
                case 'seasonal':
                    return basePrice * 0.85; // 15% –∂–µ“£—ñ–ª–¥—ñ–∫
                case 'clearance':
                    return basePrice * 0.6; // 40% –∂–µ“£—ñ–ª–¥—ñ–∫
                default:
                    return basePrice;
            }
        }

        function calculatePrice() {
            const basePrice = parseFloat(document.getElementById('basePrice').value) || 0;
            const discountType = document.getElementById('discountType').value;
            const finalPrice = calculatePriceWithDiscount(basePrice, discountType);
            document.getElementById('calculatedPrice').textContent = `‚Ç∏${finalPrice.toFixed(2)}`;
        }

        // –§–∞—Å–∞–¥ –ø–∞—Ç—Ç–µ—Ä–Ω—ñ (–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∫–µ –¥–µ–π—ñ–Ω)
        function generateReport() {
            // –ë“±–ª –±—ñ—Ä–Ω–µ—à–µ –æ–ø–µ—Ä–∞—Ü–∏—è–ª–∞—Ä–¥—ã –±—ñ—Ä—ñ–∫—Ç—ñ—Ä–µ—Ç—ñ–Ω —Ñ–∞—Å–∞–¥
            const totalValue = calculateTotalInventoryValue();
            const lowStock = getLowStockItems(10);
            const categories = getAllCategories();
            const productsByCategory = {};

            // ”®–Ω—ñ–º–¥–µ—Ä–¥—ñ —Å–∞–Ω–∞—Ç –±–æ–π—ã–Ω—à–∞ —Ç–æ–ø—Ç–∞—É
            for (let i = 0; i < categories.length; i++) {
                productsByCategory[categories[i].name] = [];
            }

            for (let i = 0; i < products.length; i++) {
                const category = getCategoryById(products[i].categoryId);
                if (category) {
                    if (!productsByCategory[category.name]) {
                        productsByCategory[category.name] = [];
                    }
                    productsByCategory[category.name].push(products[i]);
                }
            }

            // –ï—Å–µ–ø –º”ô—Ç—ñ–Ω—ñ–Ω –¥–∞–π—ã–Ω–¥–∞—É
            let report = 'üìä “ö–û–ô–ú–ê –ï–°–ï–ë–Ü\n';
            report += '==================\n\n';
            report += `–ñ–∞–ª–ø—ã “õ–æ–π–º–∞ “õ“±–Ω—ã: ‚Ç∏${totalValue.toFixed(2)}\n`;
            report += `–ë–∞—Ä–ª—ã“õ ”©–Ω—ñ–º–¥–µ—Ä: ${products.length}\n`;
            report += `–ë–∞—Ä–ª—ã“õ —Å–∞–Ω–∞—Ç—Ç–∞—Ä: ${categories.length}\n`;
            report += `–ê–∑ “õ–∞–ª“ì–∞–Ω —Ç–∞—É–∞—Ä–ª–∞—Ä: ${lowStock.length}\n\n`;
            
            report += '–°–ê–ù–ê–¢ –ë–û–ô–´–ù–®–ê ”®–ù–Ü–ú–î–ï–†:\n';
            for (let category in productsByCategory) {
                report += `\n${category}:\n`;
                if (productsByCategory[category].length > 0) {
                    for (let i = 0; i < productsByCategory[category].length; i++) {
                        const p = productsByCategory[category][i];
                        report += `  - ${p.name}: ‚Ç∏${p.price} (${p.quantity} –¥–∞–Ω–∞)\n`;
                    }
                } else {
                    report += '  ”®–Ω—ñ–º–¥–µ—Ä –∂–æ“õ\n';
                }
            }

            alert(report);
            showNotification('–ï—Å–µ–ø –¥–∞–π—ã–Ω–¥–∞–ª–¥—ã!', 'info');
        }

        // UI –§—É–Ω–∫—Ü–∏—è–ª–∞—Ä—ã
        function showModal(type) {
            if (type === 'product') {
                document.getElementById('productModalTitle').textContent = '”®–Ω—ñ–º “õ–æ—Å—É';
                document.getElementById('productForm').reset();
                document.getElementById('productId').value = '';
                document.getElementById('productModal').classList.add('active');
                updateCategorySelect();
            } else {
                document.getElementById('categoryModalTitle').textContent = '–°–∞–Ω–∞—Ç “õ–æ—Å—É';
                document.getElementById('categoryForm').reset();
                document.getElementById('categoryId').value = '';
                document.getElementById('categoryModal').classList.add('active');
            }
        }

        function closeModal(type) {
            document.getElementById(`${type}Modal`).classList.remove('active');
        }

        function updateCategorySelect() {
            const select = document.getElementById('productCategory');
            select.innerHTML = '';
            for (let i = 0; i < categories.length; i++) {
                const option = document.createElement('option');
                option.value = categories[i].id;
                option.textContent = categories[i].name;
                select.appendChild(option);
            }
        }

        function updateFilterSelect() {
            const filter = document.getElementById('categoryFilter');
            filter.innerHTML = '<option value="">–ë–∞—Ä–ª—ã“õ —Å–∞–Ω–∞—Ç—Ç–∞—Ä</option>';
            for (let i = 0; i < categories.length; i++) {
                const option = document.createElement('option');
                option.value = categories[i].id;
                option.textContent = categories[i].name;
                filter.appendChild(option);
            }
        }

        function saveProduct() {
            const productData = {
                name: document.getElementById('productName').value,
                categoryId: document.getElementById('productCategory').value,
                price: parseFloat(document.getElementById('productPrice').value),
                quantity: parseInt(document.getElementById('productQuantity').value),
                description: document.getElementById('productDescription').value
            };

            const productId = document.getElementById('productId').value;
            
            if (productId) {
                updateProduct(productId, productData);
            } else {
                createProduct(productData);
            }

            closeModal('product');
        }

        function saveCategory() {
            const categoryData = {
                name: document.getElementById('categoryName').value,
                description: document.getElementById('categoryDescription').value
            };

            const categoryId = document.getElementById('categoryId').value;
            
            if (categoryId) {
                updateCategory(categoryId, categoryData);
            } else {
                createCategory(categoryData);
            }

            closeModal('category');
        }

        function editProduct(id) {
            const product = getProductById(id);
            if (product) {
                document.getElementById('productModalTitle').textContent = '”®–Ω—ñ–º–¥—ñ ”©“£–¥–µ—É';
                document.getElementById('productId').value = product.id;
                document.getElementById('productName').value = product.name;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productQuantity').value = product.quantity;
                document.getElementById('productDescription').value = product.description || '';
                
                updateCategorySelect();
                document.getElementById('productCategory').value = product.categoryId;
                document.getElementById('productModal').classList.add('active');
            }
        }

        function editCategory(id) {
            const category = getCategoryById(id);
            if (category) {
                document.getElementById('categoryModalTitle').textContent = '–°–∞–Ω–∞—Ç—Ç—ã ”©“£–¥–µ—É';
                document.getElementById('categoryId').value = category.id;
                document.getElementById('categoryName').value = category.name;
                document.getElementById('categoryDescription').value = category.description || '';
                document.getElementById('categoryModal').classList.add('active');
            }
        }

        function renderProducts() {
            const tbody = document.getElementById('productsBody');
            const allProducts = getAllProducts();
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;

            const filteredProducts = allProducts.filter(p => {
                const matchesSearch = p.name.toLowerCase().includes(searchTerm) ||
                                     p.categoryName.toLowerCase().includes(searchTerm) ||
                                     (p.description && p.description.toLowerCase().includes(searchTerm));
                const matchesCategory = !categoryFilter || p.categoryId === parseInt(categoryFilter);
                return matchesSearch && matchesCategory;
            });

            tbody.innerHTML = '';
            for (let i = 0; i < filteredProducts.length; i++) {
                const p = filteredProducts[i];
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${p.id}</td>
                    <td>${p.name}</td>
                    <td>${p.categoryName}</td>
                    <td>‚Ç∏${p.price.toFixed(2)}</td>
                    <td style="color: ${p.quantity < 10 ? '#f14668' : 'inherit'}">${p.quantity}</td>
                    <td>
                        <span class="action-link" onclick="editProduct(${p.id})">”®“£–¥–µ—É</span>
                        <span class="action-link delete" onclick="deleteProduct(${p.id})">–ñ–æ—é</span>
                    </td>
                `;
            }
        }

        function renderCategories() {
            const tbody = document.getElementById('categoriesBody');
            tbody.innerHTML = '';
            for (let i = 0; i < categories.length; i++) {
                const c = categories[i];
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${c.id}</td>
                    <td>${c.name}</td>
                    <td>${c.description || ''}</td>
                    <td>
                        <span class="action-link" onclick="editCategory(${c.id})">”®“£–¥–µ—É</span>
                        <span class="action-link delete" onclick="deleteCategory(${c.id})">–ñ–æ—é</span>
                    </td>
                `;
            }
        }

        function updateStatistics() {
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalCategories').textContent = categories.length;
            document.getElementById('totalValue').textContent = `‚Ç∏${calculateTotalInventoryValue().toFixed(2)}`;
            document.getElementById('lowStockItems').textContent = getLowStockItems().length;
        }

        function updateAllDisplays() {
            renderProducts();
            renderCategories();
            updateStatistics();
            updateFilterSelect();
            updateCategorySelect();
        }

        function showNotification(message, type) {
            if (notificationTimeout) {
                clearTimeout(notificationTimeout);
                const oldNotification = document.querySelector('.notification');
                if (oldNotification) oldNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            notificationTimeout = setTimeout(() => {
                notification.remove();
                notificationTimeout = null;
            }, 3000);
        }

        function searchProducts() {
            renderProducts();
        }

        function filterByCategory() {
            renderProducts();
        }

        function clearAllData() {
            if (confirm('–ë–∞—Ä–ª—ã“õ –¥–µ—Ä–µ–∫—Ç–µ—Ä–¥—ñ —Ç–∞–∑–∞–ª–∞—É“ì–∞ —Å–µ–Ω—ñ–º–¥—ñ—Å—ñ–∑ –±–µ? –ë“±–ª ”ô—Ä–µ–∫–µ—Ç—Ç—ñ “õ–∞–π—Ç–∞—Ä—É –º“Ø–º–∫—ñ–Ω –µ–º–µ—Å!')) {
                products = [];
                categories = [];
                nextProductId = 1;
                nextCategoryId = 1;
                showNotification('–ë–∞—Ä–ª—ã“õ –¥–µ—Ä–µ–∫—Ç–µ—Ä —Ç–∞–∑–∞–ª–∞–Ω–¥—ã!', 'info');
                updateAllDisplays();
            }
        }

        function calculateInventoryValue() {
            const total = calculateTotalInventoryValue();
            showNotification(`“ö–æ–π–º–∞–Ω—ã“£ –∂–∞–ª–ø—ã “õ“±–Ω—ã: ‚Ç∏${total.toFixed(2)}`, 'info');
        }

        // “ö–æ–ª–¥–∞–Ω–±–∞–Ω—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è–ª–∞—É
        initData();
    </script>
</body>
</html>